<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <title>Ch·ªçn B√†n Ch∆°i</title>
    <link rel="stylesheet" href="style/choose-table.css" />
  </head>
  <body>
    <button class="back-home" onclick="window.location.href='index.html'">
      ‚Üê
    </button>
    <div class="search-container">
      <input type="text" id="search-input" placeholder="T√¨m ki·∫øm b√†n ch∆°i..." />
      <button class="create-table-btn" id="open-create-modal">
        T·∫°o B√†n M·ªõi
      </button>
    </div>

    <div class="tables-container" id="tables-container">
      <!-- C√°c b√†n ch∆°i s·∫Ω ƒë∆∞·ª£c render ·ªü ƒë√¢y -->
    </div>

    <!-- Modal T·∫°o B√†n M·ªõi -->
    <div class="create-table-modal" id="create-table-modal">
      <div class="modal-content">
        <input
          type="text"
          class="modal-input"
          placeholder="T√™n b√†n"
          id="table-name-input"
        />
        <input
          type="number"
          class="modal-input"
          placeholder="M·ª©c c∆∞·ª£c (Coins)"
          id="bet-amount-input"
        />
        <div class="modal-buttons">
          <button class="modal-btn modal-btn-create" id="create-table-confirm">
            T·∫°o B√†n
          </button>
          <button class="modal-btn modal-btn-cancel" id="create-table-cancel">
            H·ªßy
          </button>
        </div>
      </div>
    </div>

    <script>
      // D·ªØ li·ªáu m·∫´u c√°c b√†n ch∆°i
      const initialTables = [
        {
          id: 1,
          name: "Ph√≤ng Chi·∫øn Thu·∫≠t",
          currentPlayers: 2,
          maxPlayers: 4,
          betAmount: 100,
        },
        {
          id: 2,
          name: "B√†n Th√°ch ƒê·∫•u",
          currentPlayers: 1,
          maxPlayers: 2,
          betAmount: 500,
        },
        {
          id: 3,
          name: "ƒê·∫°i Chi·∫øn",
          currentPlayers: 3,
          maxPlayers: 4,
          betAmount: 200,
        },
      ];

      const tablesContainer = document.getElementById("tables-container");
      const searchInput = document.getElementById("search-input");
      const openCreateModalBtn = document.getElementById("open-create-modal");
      const createTableModal = document.getElementById("create-table-modal");
      const createTableConfirmBtn = document.getElementById(
        "create-table-confirm"
      );
      const createTableCancelBtn = document.getElementById(
        "create-table-cancel"
      );

      // Render danh s√°ch b√†n ch∆°i
      function renderTables(tables) {
        tablesContainer.innerHTML = tables
          .map(
            (table) => `
                <div class="table-card">
                    <div class="table-header">
                        <span class="table-name">${table.name}</span>
                        <div class="table-status">
                            <div class="player-count">
                                üë• ${table.currentPlayers}/${table.maxPlayers}
                            </div>
                            <span class="bet-amount">üí∞ ${table.betAmount} Coins</span>
                        </div>
                    </div>
                    <button class="join-btn" onclick="joinTable(${table.id})">
                        Tham Gia
                    </button>
                </div>
            `
          )
          .join("");
      }

      // T√¨m ki·∫øm b√†n ch∆°i
      function searchTables() {
        const searchTerm = searchInput.value.toLowerCase();
        const filteredTables = initialTables.filter((table) =>
          table.name.toLowerCase().includes(searchTerm)
        );
        renderTables(filteredTables);
      }

      // Ch·ª©c nƒÉng tham gia b√†n
      function joinTable(tableId) {
        alert(`B·∫°n ƒë√£ ch·ªçn tham gia b√†n s·ªë ${tableId}`);
        // Trong th·ª±c t·∫ø s·∫Ω c√≥ logic k·∫øt n·ªëi WebSocket
      }

      // M·ªü modal t·∫°o b√†n
      openCreateModalBtn.addEventListener("click", () => {
        createTableModal.style.display = "flex";
      });

      // ƒê√≥ng modal t·∫°o b√†n
      createTableCancelBtn.addEventListener("click", () => {
        createTableModal.style.display = "none";
      });

      // X√°c nh·∫≠n t·∫°o b√†n
      createTableConfirmBtn.addEventListener("click", () => {
        const tableName = document.getElementById("table-name-input").value;
        const betAmount = document.getElementById("bet-amount-input").value;

        if (tableName && betAmount) {
          const newTable = {
            id: initialTables.length + 1,
            name: tableName,
            currentPlayers: 1,
            maxPlayers: 4,
            betAmount: parseInt(betAmount),
          };

          initialTables.push(newTable);
          renderTables(initialTables);
          createTableModal.style.display = "none";
        } else {
          alert("Vui l√≤ng nh·∫≠p ƒë·∫ßy ƒë·ªß th√¥ng tin");
        }
      });

      // S·ª± ki·ªán t√¨m ki·∫øm
      searchInput.addEventListener("input", searchTables);

      // Kh·ªüi t·∫°o ban ƒë·∫ßu
      renderTables(initialTables);
    </script>
  </body>
</html>
